<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8"><title>Compras – ERP Gestión</title>
  <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <script>if(!localStorage.getItem('currentUser')) location.href='login.html';</script>

  <aside class="sidebar">
    <div class="brand"><a href="index.html">ERP Gestión</a></div>
    <nav class="nav">
      <a href="index.html"><i data-feather="home"></i> Dashboard</a>
      <div class="group">Operaciones</div>
      <a href="ventas.html"><i data-feather="shopping-cart"></i> Ventas</a>
      <a href="facturacion.html"><i data-feather="file-text"></i> Facturación</a>
      <a href="inventario.html"><i data-feather="archive"></i> Inventario</a>
      <a href="compras.html"><i data-feather="shopping-bag"></i> Compras</a>
      <div class="group">Administración</div>
      <a href="clientes.html"><i data-feather="users"></i> Clientes</a>
      <a href="proveedores.html"><i data-feather="truck"></i> Proveedores</a>
      <a href="configuracion.html"><i data-feather="settings"></i> Configuración</a>
      <div class="group">Reportes</div>
      <a href="estadisticas.html"><i data-feather="bar-chart-2"></i> Estadísticas</a>
      <a href="reportes.html"><i data-feather="file"></i> Reportes</a>
    </nav>
    <div class="sidebar-footer"><div class="u"></div><button id="btnLogout"><i data-feather="log-out"></i>Salir</button></div>
  </aside>

  <main class="main">
    <div class="header"><h1>Compras</h1><p>Registra nuevas órdenes y actualiza inventario</p></div>

    <section class="grid cols-2">
      <div class="card">
        <div style="font-weight:800; margin-bottom:8px;">Catálogo</div>
        <div id="poCatalog"></div>
      </div>
      <div class="card">
        <div style="font-weight:800; margin-bottom:8px;">Orden de Compra</div>
        <ul id="poCart" style="list-style:none; padding:0; margin:0 0 10px 0;"></ul>
        <div style="display:flex; gap:8px;">
          <button class="btn btn-primary" onclick="submitPO()">Registrar Orden</button>
          <button class="btn btn-gray" onclick="localStorage.removeItem('poCart'); renderPOCart();">Vaciar</button>
        </div>
      </div>
    </section>
  </main>

  <script src="assets/js/app.js"></script>
  <script>
    (function(){
      const cont = document.getElementById('poCatalog');
      const prods = Store.get('products', []).slice(0,48);
      cont.innerHTML = prods.map(p=>`
        <div class="flex" style="justify-content:space-between; align-items:center; padding:10px 0; border-bottom:1px solid var(--line);">
          <div>
            <div style="font-weight:700">${p.name}</div>
            <div style="color:var(--muted); font-size:13px;">${p.sku} • Stock: ${p.stock}</div>
          </div>
          <button class="btn btn-primary" onclick="addToPO(${p.id},1)">Agregar</button>
        </div>`).join('');
      renderPOCart();
    })();
  </script>
</body>
</html>
